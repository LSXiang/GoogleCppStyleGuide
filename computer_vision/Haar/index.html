



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="SLAM 之旅（Journey to SLAM）是用于记录分享学习 SLAM 知识的平台">
      
      
        <link rel="canonical" href="https://lsxiang.github.io/Journey2SLAM/computer_vision/Haar/">
      
      
        <meta name="author" content="Jacob.lsx">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.2">
    
    
      
        <title>Haar 特征 - SLAM 之旅</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.3020aac5.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="manifest" href="../../manifest.webmanifest">
    
    
      <link rel="stylesheet" href="../../_configurations/_theme_extra/theme_extra.css">
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-XXXXXXXX-X", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#简介" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://lsxiang.github.io/Journey2SLAM" title="SLAM 之旅" class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              SLAM 之旅
            </span>
            <span class="md-header-nav__topic">
              Haar 特征
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/LSXiang/Journey2SLAM/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    LSXiang/Journey2SLAM
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." title="主页" class="md-tabs__link">
        主页
      </a>
    
  </li>

      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../computer_vision/" title="计算机视觉基础" class="md-tabs__link md-tabs__link--active">
          计算机视觉基础
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../multiple_view_geometry/mvg/" title="多视几何" class="md-tabs__link">
          多视几何
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../state_estimation_robotics/state_estimation_robotics/" title="状态估计" class="md-tabs__link">
          状态估计
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../projects/projects/" title="开源项目" class="md-tabs__link">
          开源项目
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../others/md_template/" title="其他" class="md-tabs__link">
          其他
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://lsxiang.github.io/Journey2SLAM" title="SLAM 之旅" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    SLAM 之旅
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/LSXiang/Journey2SLAM/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    LSXiang/Journey2SLAM
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="主页" class="md-nav__link">
      主页
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../aboutSLAM/" title="关于 SLAM" class="md-nav__link">
      关于 SLAM
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      计算机视觉基础
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        计算机视觉基础
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../computer_vision/" title="计算机视觉基础概览" class="md-nav__link">
      计算机视觉基础概览
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../image_filtering/" title="图像滤波器" class="md-nav__link">
      图像滤波器
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3" checked>
    
    <label class="md-nav__link" for="nav-3-3">
      特征提取与匹配
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        特征提取与匹配
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Harris/" title="Harris 角点检测" class="md-nav__link">
      Harris 角点检测
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../FAST/" title="Fast 角点检测" class="md-nav__link">
      Fast 角点检测
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ORB/" title="ORB 特征" class="md-nav__link">
      ORB 特征
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SIFT/" title="SIFT 特征" class="md-nav__link">
      SIFT 特征
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SUFT/" title="SUFT 特征" class="md-nav__link">
      SUFT 特征
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Haar 特征
      </label>
    
    <a href="./" title="Haar 特征" class="md-nav__link md-nav__link--active">
      Haar 特征
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#简介" title="简介" class="md-nav__link">
    简介
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#多种haar-like特征" title="多种Haar-like特征" class="md-nav__link">
    多种Haar-like特征
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#快速计算积分图" title="快速计算——积分图" class="md-nav__link">
    快速计算——积分图
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#积分图构建" title="积分图构建" class="md-nav__link">
    积分图构建
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#矩形特征计算" title="矩形特征计算" class="md-nav__link">
    矩形特征计算
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#旋转矩形特征的计算" title="旋转矩形特征的计算" class="md-nav__link">
    旋转矩形特征的计算
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adaboost分类器" title="AdaBoost分类器" class="md-nav__link">
    AdaBoost分类器
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#算法流程" title="算法流程" class="md-nav__link">
    算法流程
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#参考" title="参考" class="md-nav__link">
    参考
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      多视几何
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        多视几何
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../multiple_view_geometry/mvg/" title="多视几何概览" class="md-nav__link">
      多视几何概览
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../multiple_view_geometry/linear_algebra/" title="数学背景 - 线性代数" class="md-nav__link">
      数学背景 - 线性代数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../multiple_view_geometry/RepreOf3DMoveScene/" title="三维运动场景的表示" class="md-nav__link">
      三维运动场景的表示
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      状态估计
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        状态估计
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../state_estimation_robotics/state_estimation_robotics/" title="状态估计概览" class="md-nav__link">
      状态估计概览
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      开源项目
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        开源项目
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../projects/projects/" title="开源项目概览" class="md-nav__link">
      开源项目概览
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">
    
    <label class="md-nav__link" for="nav-6-2">
      RPG-SVO
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-2">
        RPG-SVO
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../projects/rpg_svo/algorithm_framework/" title="SVO 算法框架" class="md-nav__link">
      SVO 算法框架
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../projects/rpg_svo/code_analysis/" title="SVO 代码解析" class="md-nav__link">
      SVO 代码解析
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3" type="checkbox" id="nav-6-3">
    
    <label class="md-nav__link" for="nav-6-3">
      ORB-SLAM
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-3">
        ORB-SLAM
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../projects/orb_slam/tracking/" title="跟踪线程" class="md-nav__link">
      跟踪线程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../projects/orb_slam/local_mapping/" title="局部建图线程" class="md-nav__link">
      局部建图线程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../projects/orb_slam/loop_closing/" title="回环检测线程" class="md-nav__link">
      回环检测线程
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      其他
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        其他
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../others/md_template/" title="Markdown 写作模版" class="md-nav__link">
      Markdown 写作模版
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#简介" title="简介" class="md-nav__link">
    简介
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#多种haar-like特征" title="多种Haar-like特征" class="md-nav__link">
    多种Haar-like特征
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#快速计算积分图" title="快速计算——积分图" class="md-nav__link">
    快速计算——积分图
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#积分图构建" title="积分图构建" class="md-nav__link">
    积分图构建
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#矩形特征计算" title="矩形特征计算" class="md-nav__link">
    矩形特征计算
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#旋转矩形特征的计算" title="旋转矩形特征的计算" class="md-nav__link">
    旋转矩形特征的计算
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adaboost分类器" title="AdaBoost分类器" class="md-nav__link">
    AdaBoost分类器
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#算法流程" title="算法流程" class="md-nav__link">
    算法流程
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#参考" title="参考" class="md-nav__link">
    参考
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/LSXiang/Journey2SLAM/edit/master/docs/computer_vision/Haar.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Haar 特征</h1>
                
                <h2 id="简介">简介<a class="headerlink" href="#简介" title="Permanent link"></a></h2>
<p>Haar 特征<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>是一种用于目标检测或识别的图像特征描述子，Haar 特征通常和 AdaBoost 分类器组合使用，而且由于 Haar 特征提取的实时性以及 AdaBoost 分类的准确率，使其成为人脸检测以及识别领域较为经典的算法。</p>
<h2 id="多种haar-like特征">多种Haar-like特征<a class="headerlink" href="#多种haar-like特征" title="Permanent link"></a></h2>
<p>在 Haar-like 特征<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup><sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup>提出之前，传统的人脸检测算法一般是基于图像像素值进行的，计算量较大且实时性较差。 Papageorgiou 等人最早将 Harr 小波用于人脸特征表示，Viola 和 Jones 则在此基础上，提出了多种形式的 Haar 特征。Lienhart 等人对 Haar 矩形特征做了进一步的扩展，加入了旋转 <span><span class="MathJax_Preview">45^{\circ}</span><script type="math/tex">45^{\circ}</script></span> 的矩形特征，因此现有的 Haar 特征模板主要如下图所示：</p>
<p><img alt="Haar-like 矩形特征" src="../image/Haar_like.png" /></p>
<p>在计算 Haar 特征值时，用白色区域像素值的和减去黑色区域像素值的和，也就是说白色区域的权值为正值，黑色区域的权值为负值，而且权值与矩形区域的面积成反比，抵消两种矩形区域面积不等造成的影响，保证 Haar 特征值在灰度分布均匀的区域特征值趋近于 0 。Haar 特征在一定程度上反应了图像灰度的局部变化，在人脸检测中，脸部的一些特征可由矩形特征简单刻画，例如，眼睛比周围区域的颜色要深，鼻梁比两侧颜色要浅等。</p>
<p>Haar-like 矩形特征分为多类，特征模板可用于图像中的任一位置，而且大小也可任意变化，因此 Haar 特征的取值受到特征模板的类别、位置以及大小这三种因素的影响，使得在一固定大小的图像窗口内，可以提取出大量的 Haar 特征。例如，在一个 <span><span class="MathJax_Preview">24\times 24</span><script type="math/tex">24\times 24</script></span> 的检测窗口内，矩形特征的数量可以达到 16 万个。这样就需要解决两个重要问题，快速计算 Haar 矩形特征值——积分图；筛选有效的矩形特征用于分类识别—— AdaBoost 分类器。</p>
<h2 id="快速计算积分图">快速计算——积分图<a class="headerlink" href="#快速计算积分图" title="Permanent link"></a></h2>
<h3 id="积分图构建">积分图构建<a class="headerlink" href="#积分图构建" title="Permanent link"></a></h3>
<p>在一个图像窗口中，可以提取出大量的 Haar 矩形特征区域，如果在计算 Haar 特征值时，每次都遍历矩形特征区域，将会造成大量重复计算，严重浪费时间。而积分图正是一种快速计算矩形特征的方法，其主要思想是将图像起始像素点到每一个像素点之间所形成的矩形区域的像素值的和，作为一个元素保存下来，也就是将原始图像转换为积分图 (或者求和图) ，这样在求某一矩形区域的像素和时，只需索引矩形区域 4 个角点在积分图中的取值，进行普通的加减运算，即可求得 Haar 特征值，整个过程只需遍历一次图像，计算特征的时间复杂度为常数 (O(1)) 。因此可以大大提升计算效率。</p>
<p>积分图中元素的公式定义如下：</p>
<div>
<div class="MathJax_Preview">
I_i(x,y) = \sum_{x'\leq x,y'\leq y} I(x',y')
</div>
<script type="math/tex; mode=display">
I_i(x,y) = \sum_{x'\leq x,y'\leq y} I(x',y')
</script>
</div>
<p>上式含义是在 <span><span class="MathJax_Preview">(x,y)</span><script type="math/tex">(x,y)</script></span> (第 <span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span> 行第 <span><span class="MathJax_Preview">y</span><script type="math/tex">y</script></span> 列) 位置处，积分图中元素为原图像中对应像素左上角所有像素值之和。在具体实现时，可用下式进行迭代运算。</p>
<div>
<div class="MathJax_Preview">
s(x,y)=s(x,y-1)+I(x,y) \\
I_i(x,y)=I_i(x-1,y)+s(x,y)
</div>
<script type="math/tex; mode=display">
s(x,y)=s(x,y-1)+I(x,y) \\
I_i(x,y)=I_i(x-1,y)+s(x,y)
</script>
</div>
<p><span><span class="MathJax_Preview">s(x,y)</span><script type="math/tex">s(x,y)</script></span> 为行元素累加值，初始值 <span><span class="MathJax_Preview">s(x,-1)=0,I_i(-1,y)=0</span><script type="math/tex">s(x,-1)=0,I_i(-1,y)=0</script></span> 。</p>
<h4 id="矩形特征计算">矩形特征计算<a class="headerlink" href="#矩形特征计算" title="Permanent link"></a></h4>
<p>构建好积分图后，图像中任何矩形区域的像素值累加和都可以通过简单的加减运算快速得到，如下图所示，矩形区域 D 的像素和值计算公式如下： </p>
<div>
<div class="MathJax_Preview">
Sum(D)=I_i(x_4, y_4)-I_i(x_2,y_2)-I_i(x_3,y_3)+I_i(x_1,y_1)
</div>
<script type="math/tex; mode=display">
Sum(D)=I_i(x_4, y_4)-I_i(x_2,y_2)-I_i(x_3,y_3)+I_i(x_1,y_1)
</script>
</div>
<p><img alt="矩形区域求和示意图" src="../image/rectangle.png" /></p>
<p>在下图中，以水平向右为 x 轴正方向，垂直向下为 y 轴正方向，可定义积分图公式 Summed Area Table (<span><span class="MathJax_Preview">SAT(x,y)</span><script type="math/tex">SAT(x,y)</script></span> )</p>
<div>
<div class="MathJax_Preview">
SAT(x,y)=\sum_{x'\leq x,y'\leq y} I(x',y')
</div>
<script type="math/tex; mode=display">
SAT(x,y)=\sum_{x'\leq x,y'\leq y} I(x',y')
</script>
</div>
<p>以及迭代求解式对于左上角坐标为 <span><span class="MathJax_Preview">(x,y)</span><script type="math/tex">(x,y)</script></span> ，宽高为 <span><span class="MathJax_Preview">(w,h)</span><script type="math/tex">(w,h)</script></span> 的矩形区域 <span><span class="MathJax_Preview">r(x,y,w,h,0)</span><script type="math/tex">r(x,y,w,h,0)</script></span> ，可利用积分图 <span><span class="MathJax_Preview">SAT(x,y)</span><script type="math/tex">SAT(x,y)</script></span> 求取像素和值</p>
<div>
<div class="MathJax_Preview">
\scriptsize{
\begin{align*}
RecSum(r) &amp;= SAT(x+w-1, y+h-1) \\ &amp;+ SAT(x-1, y-1) \\ &amp;- SAT(x+w-1, y-1) \\ &amp;-SAT(x-1,y+h-1)
\end{align*}
}
</div>
<script type="math/tex; mode=display">
\scriptsize{
\begin{align*}
RecSum(r) &= SAT(x+w-1, y+h-1) \\ &+ SAT(x-1, y-1) \\ &- SAT(x+w-1, y-1) \\ &-SAT(x-1,y+h-1)
\end{align*}
}
</script>
</div>
<p><img alt="积分图求矩形区域和值" src="../image/integral_rectangle.png.png" /></p>
<h4 id="旋转矩形特征的计算">旋转矩形特征的计算<a class="headerlink" href="#旋转矩形特征的计算" title="Permanent link"></a></h4>
<p>对于旋转矩形特征，相应的有 <span><span class="MathJax_Preview">45^{\circ}</span><script type="math/tex">45^{\circ}</script></span> 倾斜积分图用于快速计算 Haar 特征值，如下图所示，倾斜积分图的定义为像素点左上角 <span><span class="MathJax_Preview">45^{\circ}</span><script type="math/tex">45^{\circ}</script></span> 区域和左下角 <span><span class="MathJax_Preview">45^{\circ}</span><script type="math/tex">45^{\circ}</script></span> 区域的像素和，公式表示如下：</p>
<div>
<div class="MathJax_Preview">
RSAT(x,y)=\sum_{x'\leq x,x'\leq x-\left|y-y'\right|} I(x',y')
</div>
<script type="math/tex; mode=display">
RSAT(x,y)=\sum_{x'\leq x,x'\leq x-\left|y-y'\right|} I(x',y')
</script>
</div>
<p>其递推公式计算如下：</p>
<div>
<div class="MathJax_Preview">
\scriptsize{
RSAT(x,y)=RSAT(x-1,y-1)+RSAT(x-1,y)-RSAT(x-2,y-1)+I(x,y) \\
RSAT(x,y)=RSAT(x,y)+RSAT(x-1,y+1)-RSAT(x-2,y)
}
</div>
<script type="math/tex; mode=display">
\scriptsize{
RSAT(x,y)=RSAT(x-1,y-1)+RSAT(x-1,y)-RSAT(x-2,y-1)+I(x,y) \\
RSAT(x,y)=RSAT(x,y)+RSAT(x-1,y+1)-RSAT(x-2,y)
}
</script>
</div>
<p>其中 <span><span class="MathJax_Preview">RSAT(-1,y)=RSAT(-2,y)=RSAT(x,-1)=0</span><script type="math/tex">RSAT(-1,y)=RSAT(-2,y)=RSAT(x,-1)=0</script></span> 也可直接通过下式递归计算：</p>
<div>
<div class="MathJax_Preview">
\scriptsize{
RSAT(x,y)=RSAT(x-1,y-1)+RSAT(x+1,y-1)-RSAT(x,y-2)+I(x-1,y)+I(x,y)
}
</div>
<script type="math/tex; mode=display">
\scriptsize{
RSAT(x,y)=RSAT(x-1,y-1)+RSAT(x+1,y-1)-RSAT(x,y-2)+I(x-1,y)+I(x,y)
}
</script>
</div>
<p>以上 3 个积分图计算公式是等价的。</p>
<p><img alt="倾斜积分图求倾斜矩形区域和值" src="../image/integral_rotation_rectangle.png" /></p>
<p>如下图所示，构建好倾斜积分图后，可快速计算倾斜矩形区域<span><span class="MathJax_Preview">r=(x,y,w,h,45^{\circ})</span><script type="math/tex">r=(x,y,w,h,45^{\circ})</script></span>的像素和值</p>
<div>
<div class="MathJax_Preview">
\scriptsize{
\begin{align*}
RecSum(r) &amp;=RSAT(x+w-1,y+w-1) \\
&amp;+RSAT(x-h-1,y+h-1) \\
&amp;-RSAT(x-1,y-1) \\
&amp;-RSAT(x+w-1-h,y+w-1+h)
\end{align*}
}
</div>
<script type="math/tex; mode=display">
\scriptsize{
\begin{align*}
RecSum(r) &=RSAT(x+w-1,y+w-1) \\
&+RSAT(x-h-1,y+h-1) \\
&-RSAT(x-1,y-1) \\
&-RSAT(x+w-1-h,y+w-1+h)
\end{align*}
}
</script>
</div>
<p><img alt="倾斜矩形区域求和示意图" src="../image/rotated_rectangle.png" /></p>
<h2 id="adaboost分类器">AdaBoost分类器<a class="headerlink" href="#adaboost分类器" title="Permanent link"></a></h2>
<p>由输入图像得到积分图，通过取不同种类、大小的 Haar 特征模板，并在不同位置处，利用积分图提取 Haar 矩形特征，可快速得到大量Haar特征值，AdaBoost 分类器可用于对提取的 Haar 特征 (通常需要做归一化处理) 进行训练分类，并应用于人脸检测中。AdaBoost 是一种集成分类器，由若干个强分类级联而成，而每个强分类器又由若干个弱分类器 (例如：决策树) 组合训练得到。</p>
<p>弱分类器的定义如下：</p>
<div>
<div class="MathJax_Preview">
h_j(x)=\begin{cases} 1,&amp;p_j f_j(x) &lt; p_j \theta_j \\ 0, &amp; otherwise \end{cases}
</div>
<script type="math/tex; mode=display">
h_j(x)=\begin{cases} 1,&p_j f_j(x) < p_j \theta_j \\ 0, & otherwise \end{cases}
</script>
</div>
<p>上式中 <span><span class="MathJax_Preview">p_j</span><script type="math/tex">p_j</script></span> 是为了控制不等式的方向而设置的参数。 <span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span> 表示一个图像窗口，<span><span class="MathJax_Preview">f_j(x)</span><script type="math/tex">f_j(x)</script></span> 表示提取的 Haar 特征，阈值 <span><span class="MathJax_Preview">\theta</span><script type="math/tex">\theta</script></span> 用于判断该窗口是否为目标区域 (人脸) 。</p>
<h3 id="算法流程">算法流程<a class="headerlink" href="#算法流程" title="Permanent link"></a></h3>
<ul>
<li>
<p>假设训练样本为 <span><span class="MathJax_Preview">(x_i,y_i),i=0,1,...,n</span><script type="math/tex">(x_i,y_i),i=0,1,...,n</script></span>，<span><span class="MathJax_Preview">y_i</span><script type="math/tex">y_i</script></span> 取值为 0 (负样本)、1 (正样本)</p>
</li>
<li>
<p>初始化权重 <span><span class="MathJax_Preview">w_1,i=\dfrac{1}{2m},y_i=\dfrac{1}{2l}</span><script type="math/tex">w_1,i=\dfrac{1}{2m},y_i=\dfrac{1}{2l}</script></span> ，其中<span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>表示负样本的个数，<span><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span>表示正样本的个数</p>
</li>
<li>
<p>For <span><span class="MathJax_Preview">t =1,2,...,T</span><script type="math/tex">t =1,2,...,T</script></span> </p>
</li>
</ul>
<ol>
<li>归一化权值：<span><span class="MathJax_Preview">w_{t,i} = \dfrac{w_{t,i}}{\Sigma_{j=1}^n w_{t,j}}</span><script type="math/tex">w_{t,i} = \dfrac{w_{t,i}}{\Sigma_{j=1}^n w_{t,j}}</script></span> </li>
<li>对于每个(种)特征，训练一个分类器 (<span><span class="MathJax_Preview">h_j</span><script type="math/tex">h_j</script></span>) ，每个分类器只使用一种 Haar 特征进行训练。分类误差为 <span><span class="MathJax_Preview">\varepsilon_j = \sum_i w_i \left | h_j (x_i) - y_i \right|</span><script type="math/tex">\varepsilon_j = \sum_i w_i \left | h_j (x_i) - y_i \right|</script></span> ， <span><span class="MathJax_Preview">h_j</span><script type="math/tex">h_j</script></span> 为特征分类器，<span><span class="MathJax_Preview">x_i</span><script type="math/tex">x_i</script></span> 为训练图像样本。</li>
<li>选择最低误差的分类器 <span><span class="MathJax_Preview">h_t</span><script type="math/tex">h_t</script></span> </li>
<li>更新训练样本的权值 <span><span class="MathJax_Preview">w_{t+1,i} = w_{t,i} \beta_t^{1-e_i}</span><script type="math/tex">w_{t+1,i} = w_{t,i} \beta_t^{1-e_i}</script></span>，分类正确 <span><span class="MathJax_Preview">e_i=0</span><script type="math/tex">e_i=0</script></span> ，分类错误 <span><span class="MathJax_Preview">e_i=1</span><script type="math/tex">e_i=1</script></span> ， <span><span class="MathJax_Preview">\beta_t=\dfrac{\varepsilon_t}{1-\varepsilon_t}</span><script type="math/tex">\beta_t=\dfrac{\varepsilon_t}{1-\varepsilon_t}</script></span> </li>
</ol>
<ul>
<li>
<p>最后的强分类器为</p>
<div>
<div class="MathJax_Preview">
h(x)=\begin{cases} 1, &amp; \sum_{t=1}^T \alpha_t h_t \geq \dfrac{1}{2} \Sigma_{t=1}^T \alpha_t \\ 0,&amp; otherwise \end{cases}
</div>
<script type="math/tex; mode=display">
h(x)=\begin{cases} 1, & \sum_{t=1}^T \alpha_t h_t \geq \dfrac{1}{2} \Sigma_{t=1}^T \alpha_t \\ 0,& otherwise \end{cases}
</script>
</div>
<p>其中 <span><span class="MathJax_Preview">\alpha_t=log(\dfrac{1}{\beta_t})</span><script type="math/tex">\alpha_t=log(\dfrac{1}{\beta_t})</script></span> 。</p>
</li>
</ul>
<p>在训练多个弱分类器得到强分类器的过程中，采用了两次加权的处理方法，一是对样本进行加权，在迭代过程中，提高错分样本的权重；二是对筛选出的弱分类器 <span><span class="MathJax_Preview">h_t</span><script type="math/tex">h_t</script></span> 进行加权，弱分类器准确率越高，权重越大。此外，还需进一步对强分类器进行级联，以提高检测正确率并降低误识率。级联分类器如下所示：</p>
<p><img alt="级联分类器" src="../image/cascade.png" /></p>
<p>首先将所有待检测的子窗口输入到第一个分类器中，如果某个子窗口判决通过，则进入下一个分类器继续检测识别，否则该子窗口直接退出检测流程，也就是说后续分类器不需要处理该子窗口。通过这样一种级联的方式可以去除一些误识为目标的子窗口，降低误识率。例如，单个强分类器，99% 的目标窗口可以通过，同时50%的非目标窗口也能通过，假设有 20 个强分类器级联，那么最终的正确检测率为 <span><span class="MathJax_Preview">0.99^{20}=98\%</span><script type="math/tex">0.99^{20}=98\%</script></span> ，而错误识别率为 <span><span class="MathJax_Preview">0.50^{20} \approx 0.0001\%</span><script type="math/tex">0.50^{20} \approx 0.0001\%</script></span> ，在不影响检测准确率的同时，大大降低了误识率。当然前提是单个强分类器的准确率非常高，这样级联多个分类器才能不影响最终的准确率或者影响很小。</p>
<p>在一幅图像中，为了能够检测到不同位置的目标区域，需要以一定步长遍历整幅图像；而对于不同大小的目标，则需要改变检测窗口的尺寸，或者固定窗口而缩放图像。这样，最后检测到的子窗口必然存在相互重叠的情况，因此需要进一步对这些重叠的子窗口进行合并，也就是非极大值抑制 (NMS, non-maximum suppression) ，同时剔除零散分布的错误检测窗口。</p>
<h2 id="参考">参考<a class="headerlink" href="#参考" title="Permanent link"></a></h2>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    config: ["MMLorHTML.js"],
    jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML"],
    extensions: ["MathMenu.js", "MathZoom.js"],
    TeX: {
        TagSide: "right",
        TagIndent: ".8em",
        MultLineWidth: "85%",
        equationNumbers: {
            autoNumber: "AMS",
        }
    },
    showProcessingMessages: false,
    messageStyle: 'none'
});
</script>

<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js' async></script>

<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p><a href="http://wearables.cc.gatech.edu/paper_of_week/viola01rapid.pdf">Rapid Object Detection using a Boosted Cascade of Simple Features</a>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p><a href="https://link.springer.com/content/pdf/10.1007%2F978-3-540-45243-0_39.pdf">Empirical Analysis of Detection Cascades of Boosted Classifiers for Rapid Object Detection</a>&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p><a href="https://pdfs.semanticscholar.org/72e0/8cf12730135c5ccd7234036e04536218b6c1.pdf">Paper: An Extended Set of Haar-like Features for Rapid Object Detection</a>&#160;<a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p>Senit_Co 博客: <a href="https://senitco.github.io/2017/06/15/image-feature-haar/">图像特征提取之Haar特征</a>&#160;<a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../SUFT/" title="SUFT 特征" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  后退
                </span>
                SUFT 特征
              </span>
            </div>
          </a>
        
        
          <a href="../../multiple_view_geometry/mvg/" title="多视几何概览" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前进
                </span>
                多视几何概览
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2019. All rights reserved.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/LSXiang" class="md-footer-social__link fa fa-github"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.267712eb.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../_configurations/_theme_extra/theme_extra.js"></script>
      
    
  </body>
</html>